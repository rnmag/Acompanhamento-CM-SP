'<br>
<br>
A lista completa e atualizada de membros passa a ser:
<br>',
stri_trans_general(paste(capture.output(cat(atual_ccj, sep = " / "))), "Latin-ASCII"),
'<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>')), collapse = ""), type = "html")
# referencia_ccj <- atual_ccj
# save.image("composicoes_referencia.RData")
smtp(msg_ccj, verbose = TRUE)
}
# Compor o e-mail -------------------------------------------------------------
if (any(atual_ccj != referencia_ccj)) {
msg_ccj <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na CCJ (CM-SP)") %>%
body(paste0(capture.output(cat('<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>CCJ/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(cat(setdiff(referencia_ccj, atual_ccj), sep = ", "))), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(cat(setdiff(atual_ccj, referencia_ccj), sep = ", "))), "Latin-ASCII"),
'<br>
<br>
Te aviso se encontrar outras alterações!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>')), collapse = ""), type = "html")
# referencia_ccj <- atual_ccj
# save.image("composicoes_referencia.RData")
smtp(msg_ccj, verbose = TRUE)
}
# Compor o e-mail -------------------------------------------------------------
if (any(atual_ccj != referencia_ccj)) {
msg_ccj <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na CCJ (CM-SP)") %>%
body(paste0(capture.output(cat('<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>CCJ/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(cat(setdiff(referencia_ccj, atual_ccj), sep = ", "))), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(cat(setdiff(atual_ccj, referencia_ccj), sep = ", "))), "Latin-ASCII"),
'<br>
<br>
Estou olhando todo dia, te aviso se mudar de novo no futuro!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>')), collapse = ""), type = "html")
# referencia_ccj <- atual_ccj
# save.image("composicoes_referencia.RData")
smtp(msg_ccj, verbose = TRUE)
}
install.packages("randquotes")
library(randquotes)
randquote()
randquote()
randquote()
randquote()
# Compor o e-mail -------------------------------------------------------------
if (any(atual_ccj != referencia_ccj)) {
msg_ccj <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na CCJ (CM-SP)") %>%
body(paste0(capture.output(cat('<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>CCJ/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(cat(setdiff(referencia_ccj, atual_ccj), sep = ", "))), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(cat(setdiff(atual_ccj, referencia_ccj), sep = ", "))), "Latin-ASCII"),
'<br>
<br>
Estou olhando todo dia, e te aviso quando mudar de novo!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>')), collapse = ""), type = "html")
# referencia_ccj <- atual_ccj
# save.image("composicoes_referencia.RData")
smtp(msg_ccj, verbose = TRUE)
}
referencia_cfo <- atual_cfo
referencia_cfo[1] <- "Opa"
referencia_cfo[2] <- "Fala"
referencia_cfo[3] <- "Mano"
if (any(atual_ccj != referencia_ccj)) {
msg_ccj <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na CCJ (CM-SP)") %>%
body(paste0(capture.output(
cat(
'<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>CCJ/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(
cat(setdiff(referencia_ccj, atual_ccj), sep = ", ")
)), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(
cat(setdiff(atual_ccj, referencia_ccj), sep = ", ")
)), "Latin-ASCII"),
'<br>
<br>
Estou olhando todo dia, e te aviso quando mudar de novo!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>'
)
), collapse = ""), type = "html")
# referencia_ccj <- atual_ccj
# save.image("composicoes_referencia.RData")
smtp(msg_ccj, verbose = TRUE)
}
if (any(atual_cfo != referencia_cfo)) {
msg_cfo <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na CFO (CM-SP)") %>%
body(paste0(capture.output(
cat(
'<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>CFO/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(
cat(setdiff(referencia_cfo, atual_cfo), sep = ", ")
)), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(
cat(setdiff(atual_cfo, referencia_cfo), sep = ", ")
)), "Latin-ASCII"),
'<br>
<br>
Estou olhando todo dia, e te aviso quando mudar de novo!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>'
)
), collapse = ""), type = "html")
# referencia_ccj <- atual_ccj
# save.image("composicoes_referencia.RData")
smtp(msg_ccj, verbose = TRUE)
}
# Compor o e-mail -------------------------------------------------------------
if (any(atual_ccj != referencia_ccj)) {
msg_ccj <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na CCJ (CM-SP)") %>%
body(paste0(capture.output(
cat(
'<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>CCJ/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(
cat(setdiff(referencia_ccj, atual_ccj), sep = ", ")
)), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(
cat(setdiff(atual_ccj, referencia_ccj), sep = ", ")
)), "Latin-ASCII"),
'<br>
<br>
Estou olhando todo dia, e te aviso quando mudar de novo!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>'
)
), collapse = ""), type = "html")
# referencia_ccj <- atual_ccj
# save.image("composicoes_referencia.RData")
smtp(msg_ccj, verbose = TRUE)
}
if (any(atual_cfo != referencia_cfo)) {
msg_cfo <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na CFO (CM-SP)") %>%
body(paste0(capture.output(
cat(
'<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>CFO/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(
cat(setdiff(referencia_cfo, atual_cfo), sep = ", ")
)), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(
cat(setdiff(atual_cfo, referencia_cfo), sep = ", ")
)), "Latin-ASCII"),
'<br>
<br>
Estou olhando todo dia, e te aviso quando mudar de novo!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>'
)
), collapse = ""), type = "html")
# referencia_cfo <- atual_cfo
# save.image("composicoes_referencia.RData")
smtp(msg_cfo, verbose = TRUE)
}
referencia_met <- atual_met
if (any(atual_met != referencia_met)) {
msg_met <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na Com. de Pol. Urbana (CM-SP)") %>%
body(paste0(capture.output(
cat(
'<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>Com. de Pol. Urbana/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(
cat(setdiff(referencia_met, atual_met), sep = ", ")
)), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(
cat(setdiff(atual_met, referencia_met), sep = ", ")
)), "Latin-ASCII"),
'<br>
<br>
Estou olhando todo dia, e te aviso quando mudar de novo!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>'
)
), collapse = ""), type = "html")
# referencia_cfo <- atual_cfo
# save.image("composicoes_referencia.RData")
smtp(msg_met, verbose = TRUE)
}
referencia_met[1] <- "teste"
if (any(atual_met != referencia_met)) {
msg_met <- envelope() %>%
from("analisedeconjunturapolitica@gmail.com") %>%
to(recipientes) %>%
subject("Alerta: Novos Membros na Com. de Pol. Urbana (CM-SP)") %>%
body(paste0(capture.output(
cat(
'<p> Oi,
<br>
<br>
Detectei que foram alterados os membros da <b>Com. de Pol. Urbana/CM-SP</b>.
<br>
<br>
<b>Sai(em):</b>',
stri_trans_general(paste(capture.output(
cat(setdiff(referencia_met, atual_met), sep = ", ")
)), "Latin-ASCII"),
'<br>
<b>Entra(m)</b>:',
stri_trans_general(paste(capture.output(
cat(setdiff(atual_met, referencia_met), sep = ", ")
)), "Latin-ASCII"),
'<br>
<br>
Estou olhando todo dia, e te aviso quando mudar de novo!
<br>
<br>
Atenciosamente,
<br>
<b>ACP_bot</b>
</p>'
)
), collapse = ""), type = "html")
# referencia_cfo <- atual_cfo
# save.image("composicoes_referencia.RData")
smtp(msg_met, verbose = TRUE)
}
sessionInfo()
sessionInfo()
sessionInfo()
sessionInfo()
sessionInfo()
sessionInfo()
# Composição de referência ----------------------------------------------------
# Essa é a composição que o script vai usar como base de comparação. Se houver
# qualquer alteração no site em relação a essa referência abaixo, o script manda
# uma mensagem nos e-mails cadastrados e atualiza a composição.
load("composicoes_referencia.RData")
# Script para acompanhamento das comissões da Câmara Municipal de São Paulo. O
# código entra no site das comissões relevantes, baixa a lista de membros e a
# compara com uma lista de referência.
library(remotes)
library(emayili) # remotes::install_github("datawookie/emayili")
library(dplyr)
library(rvest)
library(here)
library(stringi)
library(rowr)
sessionInfo()
sessionInfo()
sessionInfo()
sessionInfo()
# Script para acompanhamento das comissões da Câmara Municipal de São Paulo. O
# código entra no site das comissões relevantes, baixa a lista de membros e a
# compara com uma lista de referência.
library(remotes)
library(emayili) # remotes::install_github("datawookie/emayili")
library(dplyr)
library(rvest)
library(here)
library(stringi)
library(rowr)
here()
sessionInfo()
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(forcats)
library(Cairo)
library(here)
library(binom)
library(ggcorrplot)
library(stargazer)
library(jtools)
library(ggstance)
here() # dir de trabalho
# Leitura e limpeza do banco
bd <- read_excel("bd_final.xlsx")
# tema dos gráficos
theme_set(theme_classic())
sapply(bd, class)
apply(bd, class)
lapply(bd, class)
sapply(bd, class)
sapply(bd, class)
x <- sapply(bd, class)
x
sessessionInfo()
if (10>8) {
print("opa")
}
if (10 > 8) {
print("opa")
}
if (10 > 8) {
print("opa")
}
if (10 == 8) {
print("opa")
}
if (10 == 8) {
print("opa")
}
if (10 == 10) {
print("agora sim")
}
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sessionInfo()
# Composição de referência ----------------------------------------------------
# Essa é a composição que o script vai usar como base de comparação. Se houver
# qualquer alteração no site em relação a essa referência abaixo, o script manda
# uma mensagem nos e-mails cadastrados e atualiza a composição.
load("composicoes_referencia.RData")
# Composição de referência ----------------------------------------------------
# Essa é a composição que o script vai usar como base de comparação. Se houver
# qualquer alteração no site em relação a essa referência abaixo, o script manda
# uma mensagem nos e-mails cadastrados e atualiza a composição.
load("composicoes_referencia.RData")
referencia_ccj <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-constituicao-justica-e-legislacao-participativa/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_cfo <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-financas-e-orcamento/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_met <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-politica-urbana-metropolitana-e-meio-ambiente/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_adm_pub <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-administracao-publica/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_transp <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-transito-transporte-atividade-economica-turismo-lazer-e-gastronomia/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_educ <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-educacao-cultura-e-esportes/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_trabalho <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-saude-promocao-social-trabalho-e-mulher/") %>%
html_nodes(".vereador-name") %>%
html_text()
library(remotes)
library(emayili) # remotes::install_github("datawookie/emayili")
library(dplyr)
library(rvest)
library(here)
library(stringi)
library(rowr)
referencia_ccj <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-constituicao-justica-e-legislacao-participativa/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_cfo <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-financas-e-orcamento/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_met <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-politica-urbana-metropolitana-e-meio-ambiente/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_adm_pub <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-administracao-publica/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_transp <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-transito-transporte-atividade-economica-turismo-lazer-e-gastronomia/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_educ <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-educacao-cultura-e-esportes/") %>%
html_nodes(".vereador-name") %>%
html_text()
referencia_trabalho <- read_html("http://www.saopaulo.sp.leg.br/comissao/comissoes-do-processo-legislativo/comissao-de-saude-promocao-social-trabalho-e-mulher/") %>%
html_nodes(".vereador-name") %>%
html_text()
save.image("//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/composicoes_referencia.RData")
source('//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/acompanha_comissoes_2.0.R', encoding = 'UTF-8')
referencia_adm_pub[1] <- referencia_adm_pub[2] <- referencia_adm_pub[3] <- "teste"
referencia_ccj[1] <- referencia_ccj[2] <- referencia_ccj[3] <- "teste ccj"
referencia_cfo[1] <- referencia_cfo[2] <- referencia_cfo[3] <- "teste cfo"
referencia_educ[1] <- referencia_educ[2] <- referencia_educ[3] <- "teste educ"
referencia_met[1] <- referencia_met[2] <- referencia_met[3] <- "teste met"
referencia_trabalho[1] <- referencia_trabalho[2] <- referencia_trabalho[3] <- "teste trabalho"
referencia_transp[1] <- referencia_transp[2] <- referencia_transp[3] <- "teste transp"
save.image("//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/composicoes_referencia.RData")
source('//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/acompanha_comissoes_2.0.R', encoding = 'UTF-8')
source('//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/acompanha_comissoes_2.0.R', encoding = 'UTF-8')
source('//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/acompanha_comissoes_2.0.R', encoding = 'UTF-8')
source('//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/acompanha_comissoes_2.0.R', encoding = 'UTF-8')
# Composição de referência ----------------------------------------------------
# Essa é a composição que o script vai usar como base de comparação. Se houver
# qualquer alteração no site em relação a essa referência abaixo, o script manda
# uma mensagem nos e-mails cadastrados e atualiza a composição.
load("composicoes_referencia.RData")
referencia_trabalho[1] <- "A"
referencia_trabalho[2] <- "B"
referencia_trabalho[3] <- "C"
source('//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/acompanha_comissoes_2.0.R', encoding = 'UTF-8')
referencia_trabalho[1] <- "A"
referencia_trabalho[2] <- "B"
referencia_trabalho[3] <- "C"
save.image("//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/composicoes_referencia.RData")
source('//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/acompanha_comissoes_2.0.R', encoding = 'UTF-8')
source('//192.168.15.10/conjuntura politica/Produções/2019/Panoramas/Panorama CM-SP/Acompanhamento/acompanha_comissoes_2.0.R', encoding = 'UTF-8')
sessionInfo()
